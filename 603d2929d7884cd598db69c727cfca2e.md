---
jupyter:
  colab:
  kernelspec:
    display_name: Python 3
    name: python3
  language_info:
    name: python
  nbformat: 4
  nbformat_minor: 4
---

::: {.cell .markdown _cell_guid="b1076dfc-b9ad-4769-8c92-a6c4dae69d19" _uuid="8f2839f25d086af736a60e9eeb907d3b93b6e0e5" id="jWowFQI0kEFE"}
# **A. INTRODUCTION** {#a-introduction}

According to IBM, predictive analytics is a branch of advanced analytics
that makes predictions about future outcomes using historical data
combined with statistical modeling, data mining techniques, and machine
learning. So, predictive analytics is an applied field that employs
various quantitative methods to make predictions using data. Examples of
its applications include price prediction, dose prediction, and risk
assessment.

# **B. PREDICTIVE ANALYTICS LIFECYCLE** {#b-predictive-analytics-lifecycle}

Predictive analytics employs the CRISP-DM (Cross Industry Standard
Process for Data Mining) method, which is divided into six phases,
including:

1.  Business Understanding
2.  Data Understanding
3.  Data Preparation
4.  Modeling
5.  Evaluation
6.  Deployment
:::

::: {.cell .markdown id="nimEaQyZkEFW"}
# **1. BUSINESS UNDERSTANDING** {#1-business-understanding}

The case study that will be discussed is about predicting the price of
diamonds.

**a. Problem Statements and Goals**

**Problem**:

-   Of all the features, which one has the most impact on diamond
    prices?
-   How much do diamonds with certain characteristics or features cost?

**Goals**:

-   Know the features that correlate with the price of diamonds.
-   Creating a machine learning model that can predict the price of
    diamonds as accurately as possible based on existing features.

**b. Methodology**

Build a regression project/model with the price of diamonds as the
target.

**c. Metrics**

**Metrics:**

-   Mean Squared Error (MSE)
-   Root Mean Squared Error (RMSE)

**Algorithms:**

-   K.Nearest Neighbor
-   Random Forest
-   Boosting Algorithm

# **2. DATA UNDERSTANDING** {#2-data-understanding}

The EDA stage involves an initial investigative process on the data to
analyze its characteristics, identify patterns and anomalies, and verify
assumptions.
:::

::: {.cell .code execution_count="1" id="kgNUHiBByH97"}
``` python
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
%matplotlib inline
import seaborn as sns
```
:::

::: {.cell .code execution_count="2" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":424}" id="wQMgLxL2yrEu" outputId="ae137315-e302-4ca8-bcd2-3641558a2566"}
``` python
# load the datasets

url = '/kaggle/input/seaborn-practice/diamonds.csv'
diamonds = pd.read_csv(url)
diamonds
```

::: {.output .execute_result execution_count="2"}
```{=html}

  <div id="df-9e738f63-7c17-40d1-8f38-ebe02e9e42f6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>335</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53935</th>
      <td>0.72</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI1</td>
      <td>60.8</td>
      <td>57.0</td>
      <td>2757</td>
      <td>5.75</td>
      <td>5.76</td>
      <td>3.50</td>
    </tr>
    <tr>
      <th>53936</th>
      <td>0.72</td>
      <td>Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>63.1</td>
      <td>55.0</td>
      <td>2757</td>
      <td>5.69</td>
      <td>5.75</td>
      <td>3.61</td>
    </tr>
    <tr>
      <th>53937</th>
      <td>0.70</td>
      <td>Very Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>62.8</td>
      <td>60.0</td>
      <td>2757</td>
      <td>5.66</td>
      <td>5.68</td>
      <td>3.56</td>
    </tr>
    <tr>
      <th>53938</th>
      <td>0.86</td>
      <td>Premium</td>
      <td>H</td>
      <td>SI2</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>2757</td>
      <td>6.15</td>
      <td>6.12</td>
      <td>3.74</td>
    </tr>
    <tr>
      <th>53939</th>
      <td>0.75</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI2</td>
      <td>62.2</td>
      <td>55.0</td>
      <td>2757</td>
      <td>5.83</td>
      <td>5.87</td>
      <td>3.64</td>
    </tr>
  </tbody>
</table>
<p>53940 rows Ã— 10 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9e738f63-7c17-40d1-8f38-ebe02e9e42f6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9e738f63-7c17-40d1-8f38-ebe02e9e42f6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9e738f63-7c17-40d1-8f38-ebe02e9e42f6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3891e0b1-25ab-44ad-a6c1-1d25ab0b0f5a">
  <button class="colab-df-quickchart" onclick="quickchart('df-3891e0b1-25ab-44ad-a6c1-1d25ab0b0f5a')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3891e0b1-25ab-44ad-a6c1-1d25ab0b0f5a button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
```
:::
:::

::: {.cell .code execution_count="3" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="lNviTEYY4yqG" outputId="5b5c1fae-e995-489b-b2ae-eb1fd07a1d5f"}
``` python
diamonds.info()
```

::: {.output .stream .stdout}
    <class 'pandas.core.frame.DataFrame'>

    RangeIndex: 53940 entries, 0 to 53939

    Data columns (total 10 columns):

     #   Column   Non-Null Count  Dtype  

    ---  ------   --------------  -----  

     0   carat    53940 non-null  float64

     1   cut      53940 non-null  object 

     2   color    53940 non-null  object 

     3   clarity  53940 non-null  object 

     4   depth    53940 non-null  float64

     5   table    53940 non-null  float64

     6   price    53940 non-null  int64  

     7   x        53940 non-null  float64

     8   y        53940 non-null  float64

     9   z        53940 non-null  float64

    dtypes: float64(6), int64(1), object(3)

    memory usage: 4.1+ MB
:::
:::

::: {.cell .markdown id="HsPZhXSo4-0P"}
The output shows that:

-   There are 3 columns with object types, namely: cut, color, and
    clarity. These columns are categorical features (non-numerical
    features).

-   There are 6 numeric columns with float64 data type, namely: carat,
    depth, table, x, y, and z. These are numerical features that are the
    result of physical measurements.

-   There is 1 numeric column with int64 data type, namely: price. This
    column is our target feature.
:::

::: {.cell .code execution_count="4" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":300}" id="YyhssXIt5WDB" outputId="848fb869-97a7-48ab-b29a-b8c54af607d7"}
``` python
diamonds.describe()
```

::: {.output .execute_result execution_count="4"}
```{=html}

  <div id="df-dc20ca8a-d5bb-466d-b5e9-514bb94b35d5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>53940.000000</td>
      <td>53940.000000</td>
      <td>53940.000000</td>
      <td>53940.000000</td>
      <td>53940.000000</td>
      <td>53940.000000</td>
      <td>53940.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.797940</td>
      <td>61.749405</td>
      <td>57.457184</td>
      <td>3932.799722</td>
      <td>5.731157</td>
      <td>5.734526</td>
      <td>3.538734</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.474011</td>
      <td>1.432621</td>
      <td>2.234491</td>
      <td>3989.439738</td>
      <td>1.121761</td>
      <td>1.142135</td>
      <td>0.705699</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.200000</td>
      <td>43.000000</td>
      <td>43.000000</td>
      <td>326.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.400000</td>
      <td>61.000000</td>
      <td>56.000000</td>
      <td>950.000000</td>
      <td>4.710000</td>
      <td>4.720000</td>
      <td>2.910000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.700000</td>
      <td>61.800000</td>
      <td>57.000000</td>
      <td>2401.000000</td>
      <td>5.700000</td>
      <td>5.710000</td>
      <td>3.530000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.040000</td>
      <td>62.500000</td>
      <td>59.000000</td>
      <td>5324.250000</td>
      <td>6.540000</td>
      <td>6.540000</td>
      <td>4.040000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5.010000</td>
      <td>79.000000</td>
      <td>95.000000</td>
      <td>18823.000000</td>
      <td>10.740000</td>
      <td>58.900000</td>
      <td>31.800000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-dc20ca8a-d5bb-466d-b5e9-514bb94b35d5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-dc20ca8a-d5bb-466d-b5e9-514bb94b35d5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-dc20ca8a-d5bb-466d-b5e9-514bb94b35d5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-024cb151-37d8-40fc-bfc8-eaff3455219e">
  <button class="colab-df-quickchart" onclick="quickchart('df-024cb151-37d8-40fc-bfc8-eaff3455219e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-024cb151-37d8-40fc-bfc8-eaff3455219e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
```
:::
:::

::: {.cell .markdown id="wSjAw41lkEF5"}
**a. EDA - Variable Descriptions**

-   price: in U.S. dollars (\$) is the target feature
-   carat: the weight of diamonds used as a measure of gemstones and
    jewelry
-   cut: represent the cutting quality of diamonds (Fair - Ideal)
-   color: color from J (worst) to D (best)
-   clarity: clarity of diamonds (I1 (worst), SI2, SI1, VS2, VS1, VVS2,
    VVS1, IF (best))
-   x: cut: diamonds length (mm)
-   y: diamonds width (mm)
-   x: diamonds depth (mm)
-   depth: z/mean(x,y) = 2\*z/(x+y)(43-79)
-   table: the width of the top of the diamond relative to its widest
    point.
:::

::: {.cell .markdown id="QKKv4jGakEF9"}
**b. EDA - Handle missing values**

From the result of the describe() function, the minimum value for the x,
y, and z columns is 0. As we know, x, y, and z represent the length,
width, and depth of diamonds, respectively. Diamonds cannot have
dimensions of 0 for x, y, or z. Therefore, we should suspect that this
indicates invalid data, often referred to as missing values. Let\'s
check how many missing values there are in the x, y, and z columns.

Missing value handling can be done by:

-   Deleting or dropping the missing data.
-   Replacing it with the mean or median.
-   Predicting and replacing it with regression techniques.

In this case, the missing value is handled by dropping it.
:::

::: {.cell .code execution_count="5" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="vlROjZbUUOab" outputId="a7e23772-3c08-4653-f32a-9d69bb1bdf48"}
``` python
x = (diamonds.x == 0).sum()
y = (diamonds.y == 0).sum()
z = (diamonds.z == 0).sum()

print("Sum of 0 values in column x: ", x)
print("Sum of 0 values in column y: ", y)
print("Sum of 0 values in column z: ", z)
```

::: {.output .stream .stdout}
    Sum of 0 values in column x:  8

    Sum of 0 values in column y:  7

    Sum of 0 values in column z:  20
:::
:::

::: {.cell .code execution_count="6" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":677}" id="EiZcSevvUkBR" outputId="20cf2182-f579-4f7c-da24-1a7327c5d5af"}
``` python
# check for 0 data in the z dimension
diamonds.loc[(diamonds['z']==0)]
```

::: {.output .execute_result execution_count="6"}
```{=html}

  <div id="df-202a7c3f-19f8-4962-bd10-221275b6bffa" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2207</th>
      <td>1.00</td>
      <td>Premium</td>
      <td>G</td>
      <td>SI2</td>
      <td>59.1</td>
      <td>59.0</td>
      <td>3142</td>
      <td>6.55</td>
      <td>6.48</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2314</th>
      <td>1.01</td>
      <td>Premium</td>
      <td>H</td>
      <td>I1</td>
      <td>58.1</td>
      <td>59.0</td>
      <td>3167</td>
      <td>6.66</td>
      <td>6.60</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4791</th>
      <td>1.10</td>
      <td>Premium</td>
      <td>G</td>
      <td>SI2</td>
      <td>63.0</td>
      <td>59.0</td>
      <td>3696</td>
      <td>6.50</td>
      <td>6.47</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5471</th>
      <td>1.01</td>
      <td>Premium</td>
      <td>F</td>
      <td>SI2</td>
      <td>59.2</td>
      <td>58.0</td>
      <td>3837</td>
      <td>6.50</td>
      <td>6.47</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>10167</th>
      <td>1.50</td>
      <td>Good</td>
      <td>G</td>
      <td>I1</td>
      <td>64.0</td>
      <td>61.0</td>
      <td>4731</td>
      <td>7.15</td>
      <td>7.04</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11182</th>
      <td>1.07</td>
      <td>Ideal</td>
      <td>F</td>
      <td>SI2</td>
      <td>61.6</td>
      <td>56.0</td>
      <td>4954</td>
      <td>0.00</td>
      <td>6.62</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11963</th>
      <td>1.00</td>
      <td>Very Good</td>
      <td>H</td>
      <td>VS2</td>
      <td>63.3</td>
      <td>53.0</td>
      <td>5139</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>13601</th>
      <td>1.15</td>
      <td>Ideal</td>
      <td>G</td>
      <td>VS2</td>
      <td>59.2</td>
      <td>56.0</td>
      <td>5564</td>
      <td>6.88</td>
      <td>6.83</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>15951</th>
      <td>1.14</td>
      <td>Fair</td>
      <td>G</td>
      <td>VS1</td>
      <td>57.5</td>
      <td>67.0</td>
      <td>6381</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24394</th>
      <td>2.18</td>
      <td>Premium</td>
      <td>H</td>
      <td>SI2</td>
      <td>59.4</td>
      <td>61.0</td>
      <td>12631</td>
      <td>8.49</td>
      <td>8.45</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24520</th>
      <td>1.56</td>
      <td>Ideal</td>
      <td>G</td>
      <td>VS2</td>
      <td>62.2</td>
      <td>54.0</td>
      <td>12800</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>26123</th>
      <td>2.25</td>
      <td>Premium</td>
      <td>I</td>
      <td>SI1</td>
      <td>61.3</td>
      <td>58.0</td>
      <td>15397</td>
      <td>8.52</td>
      <td>8.42</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>26243</th>
      <td>1.20</td>
      <td>Premium</td>
      <td>D</td>
      <td>VVS1</td>
      <td>62.1</td>
      <td>59.0</td>
      <td>15686</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>27112</th>
      <td>2.20</td>
      <td>Premium</td>
      <td>H</td>
      <td>SI1</td>
      <td>61.2</td>
      <td>59.0</td>
      <td>17265</td>
      <td>8.42</td>
      <td>8.37</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>27429</th>
      <td>2.25</td>
      <td>Premium</td>
      <td>H</td>
      <td>SI2</td>
      <td>62.8</td>
      <td>59.0</td>
      <td>18034</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>27503</th>
      <td>2.02</td>
      <td>Premium</td>
      <td>H</td>
      <td>VS2</td>
      <td>62.7</td>
      <td>53.0</td>
      <td>18207</td>
      <td>8.02</td>
      <td>7.95</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>27739</th>
      <td>2.80</td>
      <td>Good</td>
      <td>G</td>
      <td>SI2</td>
      <td>63.8</td>
      <td>58.0</td>
      <td>18788</td>
      <td>8.90</td>
      <td>8.85</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>49556</th>
      <td>0.71</td>
      <td>Good</td>
      <td>F</td>
      <td>SI2</td>
      <td>64.1</td>
      <td>60.0</td>
      <td>2130</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>49557</th>
      <td>0.71</td>
      <td>Good</td>
      <td>F</td>
      <td>SI2</td>
      <td>64.1</td>
      <td>60.0</td>
      <td>2130</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>51506</th>
      <td>1.12</td>
      <td>Premium</td>
      <td>G</td>
      <td>I1</td>
      <td>60.4</td>
      <td>59.0</td>
      <td>2383</td>
      <td>6.71</td>
      <td>6.67</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-202a7c3f-19f8-4962-bd10-221275b6bffa')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-202a7c3f-19f8-4962-bd10-221275b6bffa button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-202a7c3f-19f8-4962-bd10-221275b6bffa');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-2d3d74eb-06ae-45fc-9d25-5e597631e950">
  <button class="colab-df-quickchart" onclick="quickchart('df-2d3d74eb-06ae-45fc-9d25-5e597631e950')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-2d3d74eb-06ae-45fc-9d25-5e597631e950 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
```
:::
:::

::: {.cell .code execution_count="7" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="Qpk03mCCWEUV" outputId="1cc10257-8c13-4aab-a908-869b803450d8"}
``` python
# Drop rows with values 'x', 'y', dan 'z' = 0
diamonds = diamonds.loc[(diamonds[['x','y','z']]!=0).all(axis=1)]

# Check the data size to make sure the row has been dropped
diamonds.shape
```

::: {.output .execute_result execution_count="7"}
    (53920, 10)
:::
:::

::: {.cell .code execution_count="8" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":300}" id="t8i4spDNWOi-" outputId="d4993f28-9887-45ad-dc69-7aeeed9aa956"}
``` python
diamonds.describe()
```

::: {.output .execute_result execution_count="8"}
```{=html}

  <div id="df-cfd51eec-e73d-481f-b213-2d41d0fdc01e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>53920.000000</td>
      <td>53920.000000</td>
      <td>53920.000000</td>
      <td>53920.000000</td>
      <td>53920.000000</td>
      <td>53920.000000</td>
      <td>53920.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.797698</td>
      <td>61.749514</td>
      <td>57.456834</td>
      <td>3930.993231</td>
      <td>5.731627</td>
      <td>5.734887</td>
      <td>3.540046</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.473795</td>
      <td>1.432331</td>
      <td>2.234064</td>
      <td>3987.280446</td>
      <td>1.119423</td>
      <td>1.140126</td>
      <td>0.702530</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.200000</td>
      <td>43.000000</td>
      <td>43.000000</td>
      <td>326.000000</td>
      <td>3.730000</td>
      <td>3.680000</td>
      <td>1.070000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.400000</td>
      <td>61.000000</td>
      <td>56.000000</td>
      <td>949.000000</td>
      <td>4.710000</td>
      <td>4.720000</td>
      <td>2.910000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.700000</td>
      <td>61.800000</td>
      <td>57.000000</td>
      <td>2401.000000</td>
      <td>5.700000</td>
      <td>5.710000</td>
      <td>3.530000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.040000</td>
      <td>62.500000</td>
      <td>59.000000</td>
      <td>5323.250000</td>
      <td>6.540000</td>
      <td>6.540000</td>
      <td>4.040000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5.010000</td>
      <td>79.000000</td>
      <td>95.000000</td>
      <td>18823.000000</td>
      <td>10.740000</td>
      <td>58.900000</td>
      <td>31.800000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-cfd51eec-e73d-481f-b213-2d41d0fdc01e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-cfd51eec-e73d-481f-b213-2d41d0fdc01e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-cfd51eec-e73d-481f-b213-2d41d0fdc01e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-914725f3-b087-4065-b6d6-28fbd80b5a08">
  <button class="colab-df-quickchart" onclick="quickchart('df-914725f3-b087-4065-b6d6-28fbd80b5a08')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-914725f3-b087-4065-b6d6-28fbd80b5a08 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
```
:::
:::

::: {.cell .markdown id="a3u2rgQ1kEGJ"}
**c. EDA - Handle Outliers**

Outliers are samples whose values deviate significantly from the overall
scope of the main data.

In this case, we will handle outliers in a way:

-   Visualization (carat, table, x) with box plot.
-   Using the IQR (Inter Quartile Range) method to identify outliers
    that fall outside Q1 and Q3.
:::

::: {.cell .code execution_count="9" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":466}" id="UR5u6DuYaX8_" outputId="ca03e8da-9010-4c5a-ced4-59286a537527"}
``` python
sns.boxplot(x=diamonds['carat'])
```

::: {.output .execute_result execution_count="9"}
    <Axes: xlabel='carat'>
:::

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/a58788a2480cbeccdcdd3c7afc066443fb4159ce.png)
:::
:::

::: {.cell .code execution_count="10" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":466}" id="oo-nW2W4aiWU" outputId="53c028c4-27fd-406a-bb41-d5719cfb4dc7"}
``` python
sns.boxplot(x=diamonds['table'])
```

::: {.output .execute_result execution_count="10"}
    <Axes: xlabel='table'>
:::

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/6190246e5d49eb64df50e15a067a7f71a4b94dbd.png)
:::
:::

::: {.cell .code execution_count="11" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":466}" id="hAi2f2IDan5q" outputId="7b34fc07-92b6-49df-9e18-6577b995363e"}
``` python
sns.boxplot(x=diamonds['x'])
```

::: {.output .execute_result execution_count="11"}
    <Axes: xlabel='x'>
:::

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/992ae59bda6db40cae009c040a1c463995872fc4.png)
:::
:::

::: {.cell .code execution_count="12" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="80dFcV2ncJbL" outputId="a1cf0d9e-a9f5-46e8-e543-8e8de7451adc"}
``` python
# handling outliers with the IQR method
# create lower and upper bounds
Q1 = diamonds.quantile(0.25)
Q3 = diamonds.quantile(0.75)
IQR=Q3-Q1
diamonds=diamonds[~((diamonds<(Q1-1.5*IQR))|(diamonds>(Q3+1.5*IQR))).any(axis=1)]

# check the dataset size after we drop outliers
diamonds.shape
```

::: {.output .stream .stderr}
    <ipython-input-12-16b899f38432>:3: FutureWarning: The default value of numeric_only in DataFrame.quantile is deprecated. In a future version, it will default to False. Select only valid columns or specify the value of numeric_only to silence this warning.

      Q1 = diamonds.quantile(0.25)

    <ipython-input-12-16b899f38432>:4: FutureWarning: The default value of numeric_only in DataFrame.quantile is deprecated. In a future version, it will default to False. Select only valid columns or specify the value of numeric_only to silence this warning.

      Q3 = diamonds.quantile(0.75)

    <ipython-input-12-16b899f38432>:6: FutureWarning: Automatic reindexing on DataFrame vs Series comparisons is deprecated and will raise ValueError in a future version. Do `left, right = left.align(right, axis=1, copy=False)` before e.g. `left == right`

      diamonds=diamonds[~((diamonds<(Q1-1.5*IQR))|(diamonds>(Q3+1.5*IQR))).any(axis=1)]
:::

::: {.output .execute_result execution_count="12"}
    (47524, 10)
:::
:::

::: {.cell .code execution_count="13" id="TBZ9-S_MdwDQ"}
``` python
numerical_features = ['price', 'carat', 'depth', 'table', 'x', 'y', 'z']
categorical_features = ['cut', 'color', 'clarity']
```
:::

::: {.cell .code execution_count="14" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":614}" id="_5udvn7NeDbN" outputId="ad1d2006-1a08-4cbf-b94e-c6df6297c816"}
``` python
# EDA - UNIVARIATE
# CATEGORICAL FEATURES
# Cut Feature
feature = categorical_features[0]
count = diamonds[feature].value_counts()
percent = 100*diamonds[feature].value_counts(normalize=True)
df = pd.DataFrame({'number of samples':count, 'percentages':percent.round(1)})
print(df)
count.plot(kind='bar', title=feature);
```

::: {.output .stream .stdout}
               number of samples  percentages

    Ideal                  20340         42.8

    Premium                12115         25.5

    Very Good              10994         23.1

    Good                    3745          7.9

    Fair                     330          0.7
:::

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/26c5e6896f632910a444519f36fbd784c0151e31.png)
:::
:::

::: {.cell .markdown id="60XQkD6ae0SH"}
There are five categories in the Cut feature, listed in descending order
based on quantity: Ideal, Premium, Very Good, Good, and Fair. According
to the percentage data, it can be inferred that over 60% of the samples
consist of high-grade diamonds, specifically Ideal and Premium grades.
:::

::: {.cell .code execution_count="15" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":588}" id="Pvmv7-mhe12F" outputId="b7a9335d-02ed-4bb0-8ecb-d7d984f5ff3d"}
``` python
# Color Feature
feature = categorical_features[1]
count = diamonds[feature].value_counts()
percent = 100*diamonds[feature].value_counts(normalize=True)
df = pd.DataFrame({'number of samples':count, 'percentages':percent.round(1)})
print(df)
count.plot(kind='bar', title=feature);
```

::: {.output .stream .stdout}
       number of samples  percentages

    G              10081         21.2

    E               8910         18.7

    F               8466         17.8

    H               7176         15.1

    D               6195         13.0

    I               4462          9.4

    J               2234          4.7
:::

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/783ffa350058ceeabd0d3f7287c4d4c022f72844.png)
:::
:::

::: {.cell .markdown id="PyevWHjFfN_R"}
Based on the variable descriptions, the order of color categories from
the worst to the best is J, I, H, G, F, E, and D. From the graph above,
we can conclude that most of the grades are in the middle grades, namely
G, F, H.
:::

::: {.cell .code execution_count="16" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":631}" id="X724SLkIfPUw" outputId="66436c63-b2d2-47df-ad89-a9d6f08c9089"}
``` python
# Clarity Feature
feature = categorical_features[2]
count = diamonds[feature].value_counts()
percent = 100*diamonds[feature].value_counts(normalize=True)
df = pd.DataFrame({'number of samples':count, 'percentages':percent.round(1)})
print(df)
count.plot(kind='bar', title=feature);
```

::: {.output .stream .stdout}
          number of samples  percentages

    SI1               11552         24.3

    VS2               10928         23.0

    SI2                7402         15.6

    VS1                7373         15.5

    VVS2               4683          9.9

    VVS1               3463          7.3

    IF                 1650          3.5

    I1                  473          1.0
:::

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/e385197897ec343355af875eb869f73401cda4ba.png)
:::
:::

::: {.cell .markdown id="AIz2vafTfvhp"}
Based on the information from the variable description, the Clarity
feature consists of 8 categories from the worst to the best, namely: I1,
SI2, SI1, VS2, VS1, VVS2, VVS1, and IF.

-   \'IF\' - Internally Flawless
-   \'VVS2\' - Very Very Slight Inclusions
-   \'VVS1\' - Very Very Slight Inclusions
-   \'VS1\' - Very Slight Inclusions
-   \'VS2\' - Very Slight Inclusions
-   \'SI2\' - Slight Inclusions
-   \'SI1\' - Slight Inclusions
-   \'I1\' - Imperfect

From the graph we can conclude that most of the features are low grade,
namely SI1, SI2, and VS2.
:::

::: {.cell .code execution_count="17" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":954}" id="6JOUQbpmf_mv" outputId="f06d2eff-231e-44bf-9ee3-9fdd90f5b9db"}
``` python
# NUMERICAL FEATURES
diamonds.hist(bins=50, figsize=(20,15))
plt.show()
```

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/27c01e45d0c2fd6888da851c7e5db6d8de50e6a4.png)
:::
:::

::: {.cell .markdown id="liHkgKR4gmUv"}
Let\'s look at the histogram above, especially the histogram for the
variable \"price\" which is the target feature (label) in our data. From
the \"price\" histogram, we can get some information, including:

-   The increase in the price of diamonds is proportional to the
    decrease in the number of samples. This can be clearly seen from the
    \"price\" histogram where the graph decreases as the number of
    samples increases (x-axis).
-   The price range of diamonds is quite high, ranging from hundreds of
    US dollars to around 11800 US dollars.
-   Half of the diamond prices are below \$2500.
-   The price distribution is right-skewed. This will have implications
    for the model.
:::

::: {.cell .code execution_count="18" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":1000}" id="Vu92vg6GhzfX" outputId="21bcbe3f-c154-4d77-8cc7-11420a07f25a"}
``` python
# EDA - MULTIVARIATE
# CATEGORICAL FEATURES
cat_features = diamonds.select_dtypes(include='object').columns.to_list()

for col in cat_features:
  sns.catplot(x=col, y="price", kind="bar", dodge=False, height = 4, aspect = 3,  data=diamonds, palette="Set3")
  plt.title("Average 'price' Relative to - {}".format(col))
```

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/a27a04c86cae7a772b691ba9e22aceb2a02762cb.png)
:::

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/571d458824784e805ad93e104940793e18fa635b.png)
:::

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/e15cbd73edd6b34af173140b95f1a16ef703f996.png)
:::
:::

::: {.cell .markdown id="_ckQQfDakV6R"}
By observing the average price relative to the category features above,
we get the following insights:

-   On the \'cut\' feature, the average price tends to be similar. The
    range is between 3500 to 4500. The highest grade, Ideal grade, has
    the lowest average price among the other grades. Thus, the cut
    feature has little influence or impact on the average price.
-   In the \'color\' feature, the lower the color grade, the higher the
    price of diamonds. From this it can be concluded that color has a
    low influence on price.
-   On the \'clarity\' feature, in general, diamonds with lower grades
    have higher prices. This means that the \'clarity\' feature has a
    low influence on price. To conclude, category features have a low
    influence on price.
:::

::: {.cell .code execution_count="19" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":1000}" id="8orDESpypDzt" outputId="3f4cda23-9d8b-43da-b48b-5d2d1a4fe62f"}
``` python
# NUMERICAL FEATURES
# Observing the relationship between numerical features with the pairplot() function
sns.pairplot(diamonds, diag_kind = 'kde')
```

::: {.output .execute_result execution_count="19"}
    <seaborn.axisgrid.PairGrid at 0x7cac99a40730>
:::

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/c2866d2e46e2e08d000668627cb2fc2acd001ba0.png)
:::
:::

::: {.cell .markdown id="ZKbyGWDbpqJo"}
The pairplot function from the seaborn library illustrates pair
relations within the dataset. For instance, it depicts the relationship
between the feature \'x\' on the x-axis and the feature \'z\' on the
y-axis, as well as the relationship between the feature \'carat\' on the
x-axis and \'price\' on the y-axis. The graph visually represents the
relation plot of each numeric feature in the dataset.

In this context, we aim to examine the relationship between all numeric
features and our target feature \'price.\' To interpret this, observe
the features on the y-axis, locate the target feature \'price,\' and
examine the relation graph between all features on the x-axis and the
\'price\' feature on the y-axis. In this scenario, the feature \'price\'
occupies the fourth row from the top on the y-axis (indicated by the red
box). Consequently, we only need to focus on the relationship between
numeric features and the target feature \'price\' within that specific
row.
:::

::: {.cell .code execution_count="20" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":779}" id="6H6EZ-RdppWv" outputId="5919e31e-c8c4-4403-f386-068630f528b7"}
``` python
# EVALUATION OF CORRELATION SCORES
plt.figure(figsize=(10, 8))
correlation_matrix = diamonds.corr().round(2)

# To print the value in the box, use the anot=True parameter
sns.heatmap(data=correlation_matrix, annot=True, cmap='coolwarm', linewidths=0.5, )
plt.title("Correlation Matrix for Numeric Features ", size=20)
```

::: {.output .stream .stderr}
    <ipython-input-20-d2d149f779e8>:3: FutureWarning: The default value of numeric_only in DataFrame.corr is deprecated. In a future version, it will default to False. Select only valid columns or specify the value of numeric_only to silence this warning.

      correlation_matrix = diamonds.corr().round(2)
:::

::: {.output .execute_result execution_count="20"}
    Text(0.5, 1.0, 'Correlation Matrix for Numeric Features ')
:::

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/f53f7bc7269e2b20bb7c52b990422b8a493522d3.png)
:::
:::

::: {.cell .markdown id="24xDNhZrr1ka"}
The correlation coefficient ranges between -1 and +1, measuring the
strength and direction (positive or negative) of the relationship
between two variables. In terms of the relationship strength, the closer
the value is to 1 or -1, the stronger the correlation, while a value
closer to 0 indicates a weaker correlation.

The direction of the correlation between two variables can be positive
(both variables tend to increase together) or negative (one variable
tends to increase as the other decreases).

Now, returning to the correlation graph above, if we observe it, we can
see that the features \'carat,\' \'x,\' \'y,\' and \'z\' have a high
correlation score (above 0.9) with the target feature \'price.\' This
indicates a strong correlation between the \'price\' feature and these
four features. Meanwhile, the \'depth\' feature has a very small
correlation (0.01), suggesting that this feature can be dropped.
:::

::: {.cell .code execution_count="21" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":206}" id="boIZRZCPrikc" outputId="623b4f3b-c577-433f-add7-31a742ff8082"}
``` python
diamonds.drop(['depth'], inplace=True, axis=1)
diamonds.head()
```

::: {.output .execute_result execution_count="21"}
```{=html}

  <div id="df-b7e55899-5601-4e07-82c8-15f7d507ebe3" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>58.0</td>
      <td>335</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.24</td>
      <td>Very Good</td>
      <td>J</td>
      <td>VVS2</td>
      <td>57.0</td>
      <td>336</td>
      <td>3.94</td>
      <td>3.96</td>
      <td>2.48</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b7e55899-5601-4e07-82c8-15f7d507ebe3')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b7e55899-5601-4e07-82c8-15f7d507ebe3 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b7e55899-5601-4e07-82c8-15f7d507ebe3');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d31b2f79-282c-434d-9d5c-e32b4aa679c4">
  <button class="colab-df-quickchart" onclick="quickchart('df-d31b2f79-282c-434d-9d5c-e32b4aa679c4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d31b2f79-282c-434d-9d5c-e32b4aa679c4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
```
:::
:::

::: {.cell .markdown id="2GiY9sq0K1TY"}
# **3. DATA PREPARATION** {#3-data-preparation}

We have three categorical variables in our dataset, namely \'cut,\'
\'color,\' and \'clarity.\' Let\'s perform this encoding process with
the get_dummies feature.
:::

::: {.cell .code execution_count="23" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":256}" id="azQuLqq6KC-L" outputId="d80503f8-f50c-408d-dbb7-c08d3df0a1df"}
``` python
# CATEGORICAL FEATURE ENCODING
from sklearn.preprocessing import  OneHotEncoder
diamonds = pd.concat([diamonds, pd.get_dummies(diamonds['cut'], prefix='cut')],axis=1)
diamonds = pd.concat([diamonds, pd.get_dummies(diamonds['color'], prefix='color')],axis=1)
diamonds = pd.concat([diamonds, pd.get_dummies(diamonds['clarity'], prefix='clarity')],axis=1)
diamonds.drop(['cut','color','clarity'], axis=1, inplace=True)
diamonds.head()
```

::: {.output .execute_result execution_count="23"}
```{=html}

  <div id="df-fafc85fd-c867-45f1-944f-6180fc0f8403" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
      <th>cut_Fair</th>
      <th>cut_Good</th>
      <th>cut_Ideal</th>
      <th>cut_Premium</th>
      <th>...</th>
      <th>color_I</th>
      <th>color_J</th>
      <th>clarity_I1</th>
      <th>clarity_IF</th>
      <th>clarity_SI1</th>
      <th>clarity_SI2</th>
      <th>clarity_VS1</th>
      <th>clarity_VS2</th>
      <th>clarity_VVS1</th>
      <th>clarity_VVS2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>58.0</td>
      <td>335</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.24</td>
      <td>57.0</td>
      <td>336</td>
      <td>3.94</td>
      <td>3.96</td>
      <td>2.48</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows Ã— 26 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fafc85fd-c867-45f1-944f-6180fc0f8403')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fafc85fd-c867-45f1-944f-6180fc0f8403 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fafc85fd-c867-45f1-944f-6180fc0f8403');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-b2261ca6-e091-4068-bc53-3395bb46d907">
  <button class="colab-df-quickchart" onclick="quickchart('df-b2261ca6-e091-4068-bc53-3395bb46d907')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-b2261ca6-e091-4068-bc53-3395bb46d907 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
```
:::
:::

::: {.cell .markdown id="bbJuDdRWLMm_"}
Now, our category variable has turned into a numeric variable.
:::

::: {.cell .code execution_count="24" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":758}" id="zMYhC2lDLOZe" outputId="d23477f3-2eec-4ca5-c9b4-6b715b55d0be"}
``` python
# DIMENSIONAL REDUCTION WITH PCA
sns.pairplot(diamonds[['x','y','z']], plot_kws={"s": 3});
```

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/94578bfdb8dbfab5897280c23a7b4d0caa128b85.png)
:::
:::

::: {.cell .code execution_count="25" id="dGDrn7oSOvmh"}
``` python
from sklearn.decomposition import PCA

pca = PCA(n_components=3, random_state=123)
pca.fit(diamonds[['x','y','z']])
princ_comp = pca.transform(diamonds[['x','y','z']])
```
:::

::: {.cell .markdown id="mZWIYdSsO1xH"}
The code above invokes the PCA() class from the scikit-learn library.
The parameters passed into the class include n_components and
random_state. The n_components parameter represents the number of
components or dimensions, with three components (\'x\', \'y\', and
\'z\') specified in our case.

Meanwhile, the random_state parameter manages the random number
generator. This parameter takes an integer value, and in this instance,
we set it to random_state = 123. Regardless of the specific integer
chosen, as long as it is an integer, the function (in this case, the PCA
class) will yield the same result every time it is called.

The purpose of specifying the random_state parameter is to ensure
consistency in the dataset division, providing the same data each time
the model is executed. If left unspecified, each split would result in
different training and testing data, thereby influencing the accuracy of
the machine learning model, causing variations with each run.
:::

::: {.cell .code execution_count="26" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="zcg2DJMpO1UM" outputId="692b89b1-3c9a-4612-8cb5-cb4b38b092a8"}
``` python
pca.explained_variance_ratio_.round(3)
```

::: {.output .execute_result execution_count="26"}
    array([0.998, 0.002, 0.001])
:::
:::

::: {.cell .markdown id="pUi60rFsPscT"}
The meaning of the above output is that 99.8% of the information on the
three features \'x\', \'y\', \'z\' is contained in the first PC. The
remaining 0.2% and 0.1% are contained in the second and third PCs,
respectively. Note that the sum is \>100%. This is due to the rounding
process in 3 decimal places, so no need to worry.
:::

::: {.cell .markdown id="q-kgTqpIPt81"}
Based on these results, we will reduce the features (dimensions) and
retain only the first principal component (PC). This first PC will serve
as the dimension or size feature of the diamond, replacing the other
three features (\'x\', \'y\', \'z\'). We will refer to this feature as
\'dimension\'
:::

::: {.cell .markdown id="Z3_XACNWQH1d"}
Now you will create a new feature called \'dimension\' to replace the
\'x\', \'y\', and \'z\' features. Therefore, let\'s run the above code
with the following changes:

-   Use n_component = 1, because this time, we only have one component.
-   Fit the model to the input data.
-   Add a new feature to the dataset named \'dimension\' and perform the
    transformation process.
-   Drop the \'x\', \'y\', and \'z\' columns.
:::

::: {.cell .code execution_count="27" id="cgIz-TqEPz6T"}
``` python
from sklearn.decomposition import PCA
pca = PCA(n_components=1, random_state=123)
pca.fit(diamonds[['x','y','z']])
diamonds['dimension'] = pca.transform(diamonds.loc[:, ('x','y','z')]).flatten()
diamonds.drop(['x','y','z'], axis=1, inplace=True)
```
:::

::: {.cell .code execution_count="28" colab="{\"base_uri\":\"https://localhost:8080/\"}" id="eBOUmTZ5SeV5" outputId="4c04fe7f-ebe1-43b3-ba86-ca4d41b67229"}
``` python
# Train-Test-Split
from sklearn.model_selection import train_test_split

X = diamonds.drop(["price"],axis =1)
y = diamonds["price"]
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.1, random_state = 123)

print(f'Total # of sample in whole dataset: {len(X)}')
print(f'Total # of sample in train dataset: {len(X_train)}')
print(f'Total # of sample in test dataset: {len(X_test)}')
```

::: {.output .stream .stdout}
    Total # of sample in whole dataset: 47524

    Total # of sample in train dataset: 42771

    Total # of sample in test dataset: 4753
:::
:::

::: {.cell .code execution_count="29" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":206}" id="0de_5p01Snur" outputId="d11b3209-f811-41cc-f32e-43fcf5eef99c"}
``` python
# STANDARDIZATION
from sklearn.preprocessing import StandardScaler

numerical_features = ['carat', 'table', 'dimension']
scaler = StandardScaler()
scaler.fit(X_train[numerical_features])
X_train[numerical_features] = scaler.transform(X_train.loc[:, numerical_features])
X_train[numerical_features].head()
```

::: {.output .execute_result execution_count="29"}
```{=html}

  <div id="df-178e5b81-bd4c-446b-9224-c2adb714f019" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>table</th>
      <th>dimension</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>536</th>
      <td>-0.026226</td>
      <td>0.864091</td>
      <td>0.143464</td>
    </tr>
    <tr>
      <th>21293</th>
      <td>1.348407</td>
      <td>1.359644</td>
      <td>1.353588</td>
    </tr>
    <tr>
      <th>45577</th>
      <td>-0.511390</td>
      <td>-0.622566</td>
      <td>-0.372761</td>
    </tr>
    <tr>
      <th>37379</th>
      <td>-0.834833</td>
      <td>-0.622566</td>
      <td>-0.905790</td>
    </tr>
    <tr>
      <th>38240</th>
      <td>-0.861787</td>
      <td>-0.622566</td>
      <td>-0.813165</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-178e5b81-bd4c-446b-9224-c2adb714f019')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-178e5b81-bd4c-446b-9224-c2adb714f019 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-178e5b81-bd4c-446b-9224-c2adb714f019');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-728456c6-33e5-4a08-ad02-eccb9969d25e">
  <button class="colab-df-quickchart" onclick="quickchart('df-728456c6-33e5-4a08-ad02-eccb9969d25e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-728456c6-33e5-4a08-ad02-eccb9969d25e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
```
:::
:::

::: {.cell .markdown id="YLJXfXilU1Fs"}
The StandardScaler standardizes features by subtracting the mean and
then dividing by the standard deviation, effectively shifting the
distribution. This process results in a distribution with a standard
deviation of 1 and a mean of 0. Approximately 68% of the values will
fall within the range of -1 to 1.
:::

::: {.cell .markdown id="2mfb042ZUYsO"}
As mentioned earlier, the standardization process changes the mean value
to 0 and the standard deviation value to 1. To verify these values
post-standardization, run this code:
:::

::: {.cell .code execution_count="30" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":300}" id="9cTODYTDUe3E" outputId="011d3532-4556-4495-a9ab-ac90383cd2cb"}
``` python
X_train[numerical_features].describe().round(4)
```

::: {.output .execute_result execution_count="30"}
```{=html}

  <div id="df-9e91b374-72a4-40b7-8187-b54cd827356e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>table</th>
      <th>dimension</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>42771.0000</td>
      <td>42771.0000</td>
      <td>42771.0000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.0000</td>
      <td>-0.0000</td>
      <td>-0.0000</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.0000</td>
      <td>1.0000</td>
      <td>1.0000</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.3739</td>
      <td>-2.6048</td>
      <td>-1.8867</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.8887</td>
      <td>-0.6226</td>
      <td>-0.9283</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-0.2688</td>
      <td>-0.1270</td>
      <td>-0.1063</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.8093</td>
      <td>0.8641</td>
      <td>0.8847</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.4777</td>
      <td>3.0941</td>
      <td>2.6998</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9e91b374-72a4-40b7-8187-b54cd827356e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9e91b374-72a4-40b7-8187-b54cd827356e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9e91b374-72a4-40b7-8187-b54cd827356e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e598c3e1-8db5-418d-845b-9b7f904fb785">
  <button class="colab-df-quickchart" onclick="quickchart('df-e598c3e1-8db5-418d-845b-9b7f904fb785')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e598c3e1-8db5-418d-845b-9b7f904fb785 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
```
:::
:::

::: {.cell .markdown id="jIGHEo1qUkWj"}
# **4. DEVELOPMENT MODEL** {#4-development-model}

Look at the table above, now the mean value = 0 and standard deviation =
1.
:::

::: {.cell .code execution_count="31" id="n4C-STomO6HQ"}
``` python
# Set up a dataframe for model analysis
models = pd.DataFrame(index=['train_mse', 'test_mse'],
                      columns=['KNN', 'RandomForest', 'Boosting'])
```
:::

::: {.cell .markdown id="EevwIpCJvGq_"}
The algorithm to be used:

-   K-Nearest Neighbor
-   Random Forest
-   Boosting Algoritm
:::

::: {.cell .code execution_count="32" id="wKrzp166PJPZ"}
``` python
# DEVELOPMENT MODEL - K NEAREST NEIGHBOR
from sklearn.neighbors import KNeighborsRegressor
from sklearn.metrics import mean_squared_error

knn = KNeighborsRegressor(n_neighbors=10)
knn.fit(X_train, y_train)

models.loc['train_mse','knn'] = mean_squared_error(y_pred = knn.predict(X_train), y_true=y_train)
```
:::

::: {.cell .markdown id="EXGPSCoLPp0y"}
We use k = 10 neighbors and the Euclidean metric to measure the distance
between points. At this stage we only train the training data and save
the testing data for the evaluation stage which will be discussed in the
Model Evaluation Module.
:::

::: {.cell .code execution_count="33" id="kY75Nju-Pq1o"}
``` python
# MODEL DEVELOPMENT - RANDOM FOREST
# Import the required libraries
from sklearn.ensemble import RandomForestRegressor

# create a prediction model
RF = RandomForestRegressor(n_estimators=50, max_depth=16, random_state=55, n_jobs=-1)
RF.fit(X_train, y_train)

models.loc['train_mse','RandomForest'] = mean_squared_error(y_pred=RF.predict(X_train), y_true=y_train)
```
:::

::: {.cell .markdown id="GFXZzHEjT9C3"}
Take a look at the code snippet above. First, import
RandomForestRegressor from the scikit-learn library. Also, import
mean_squared_error as a metric to evaluate the model performance. Next,
create the RF variable and call RandomForestRegressor with specific
parameter values. The parameters used are as follows:

-   n_estimators: the number of trees in the forest. Here, we set
    n_estimators to 50.
-   max_depth: the depth or length of the tree. It is a measure of how
    much the tree can split to divide each node into the desired number
    of observations.
-   random_state: used to control the random number generator.
-   n_jobs: the number of jobs used in parallel. This component controls
    threads or processes running in parallel. Setting n_jobs to -1 means
    that all processes run in parallel.
:::

::: {.cell .code execution_count="34" id="PdN4kG19xKAq"}
``` python
# MODEL DEVELOPMENT - BOOSTING ALGORITHM
from sklearn.ensemble import AdaBoostRegressor

boosting = AdaBoostRegressor(learning_rate=0.05, random_state=55)
boosting.fit(X_train, y_train)
models.loc['train_mse','Boosting'] = mean_squared_error(y_pred=boosting.predict(X_train), y_true=y_train)
```
:::

::: {.cell .markdown id="uIc5PQ_Axaoy"}
The following are the parameters used in the code snippet above.

-   learning_rate: the weight applied to each regressor in each boosting
    iteration process.
-   random_state: used to control the random number generator used.
:::

::: {.cell .markdown id="1YiXovvSDH_9"}
# **5. EVALUATION MODEL** {#5-evaluation-model}

Before calculating the MSE value in the model, it is necessary to
perform the scaling process on the numerical features of the test data.
Previously, we only applied the scaling process to the training data to
prevent data leakage. Now, after training the model with three
algorithms, namely KNN, Random Forest, and Adaboost, it is crucial to
execute the scaling process on the test data. This ensures that the
scale between the training and test data remains consistent for proper
evaluation.
:::

::: {.cell .code execution_count="35" id="38leyPFqxd01"}
``` python
# Scaling the numeric features in X_test so that they have mean=0 and variance=1.
X_test.loc[:, numerical_features] = scaler.transform(X_test[numerical_features])
```
:::

::: {.cell .code execution_count="36" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":143}" id="le8ONmOJDdt_" outputId="cadd243d-2376-4c6d-86f2-b8921531c3da"}
``` python
# MSE Evaluation
# Create an MSE variable containing the dataframe MSE values for both the train and test data for each algorithm.
mse = pd.DataFrame(columns=['train', 'test'], index=['KNN','RF','Boosting'])

# Create a dictionary for each algorithm used
model_dict = {'KNN': knn, 'RF': RF, 'Boosting': boosting}

# Calculate the Mean Squared Error of each algorithm on train and test data
for name, model in model_dict.items():
    mse.loc[name, 'train'] = mean_squared_error(y_true=y_train, y_pred=model.predict(X_train))/1e3
    mse.loc[name, 'test'] = mean_squared_error(y_true=y_test, y_pred=model.predict(X_test))/1e3

# MSE
mse
```

::: {.output .execute_result execution_count="36"}
```{=html}

  <div id="df-e5c698aa-c139-44bb-b5e8-b8dcee4e68e4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>train</th>
      <th>test</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>KNN</th>
      <td>203.761114</td>
      <td>239.529923</td>
    </tr>
    <tr>
      <th>RF</th>
      <td>52.287366</td>
      <td>130.788418</td>
    </tr>
    <tr>
      <th>Boosting</th>
      <td>904.838013</td>
      <td>846.212966</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e5c698aa-c139-44bb-b5e8-b8dcee4e68e4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e5c698aa-c139-44bb-b5e8-b8dcee4e68e4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e5c698aa-c139-44bb-b5e8-b8dcee4e68e4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3bc99c27-e4fe-4ede-9979-b8dcab32b468">
  <button class="colab-df-quickchart" onclick="quickchart('df-3bc99c27-e4fe-4ede-9979-b8dcab32b468')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3bc99c27-e4fe-4ede-9979-b8dcab32b468 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
```
:::
:::

::: {.cell .markdown id="cbZKDrKNDsRU"}
Take a look at the code snippet above. When calculating the Mean Squared
Error value for both the train and test data, we divide it by 1e3. This
is done to prevent the MSE value from becoming excessively large
:::

::: {.cell .code execution_count="37" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":430}" id="FsWvtf4cDwAM" outputId="bd52da3f-3d98-4f37-8da4-1b72a840b755"}
``` python
# PLOT THE METRIC
fig, ax = plt.subplots()
mse.sort_values(by='test', ascending=False).plot(kind='barh', ax=ax, zorder=3)
ax.grid(zorder=0)
```

::: {.output .display_data}
![](vertopal_603d2929d7884cd598db69c727cfca2e/af0df0de3e86341164a511350555b5b7ab58f941.png)
:::
:::

::: {.cell .markdown id="ISr9R1O8D9oc"}
From the figure above, it can be seen that the Random Forest (RF) model
yields the smallest error value, while the model employing the Boosting
algorithm exhibits the largest error (as indicated on the graph with a
value exceeding 800). Consequently, we have chosen the model with the
Boosting algorithm as the best one for predicting the price of diamonds.
:::

::: {.cell .code execution_count="38" colab="{\"base_uri\":\"https://localhost:8080/\",\"height\":81}" id="NK5Q9PlIEHFS" outputId="e738044a-37d9-4af0-a0bd-2135afbf4294"}
``` python
# TESTING
predict = X_test.iloc[:1].copy()
pred_dict = {'y_true':y_test[:1]}
for name, model in model_dict.items():
    pred_dict['prediction_'+name] = model.predict(predict).round(1)

pd.DataFrame(pred_dict)
```

::: {.output .execute_result execution_count="38"}
```{=html}

  <div id="df-a4fc57ef-7bc6-43b6-ad6a-40d1f16b28d8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y_true</th>
      <th>prediction_KNN</th>
      <th>prediction_RF</th>
      <th>prediction_Boosting</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>35096</th>
      <td>886</td>
      <td>923.2</td>
      <td>884.2</td>
      <td>788.1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a4fc57ef-7bc6-43b6-ad6a-40d1f16b28d8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a4fc57ef-7bc6-43b6-ad6a-40d1f16b28d8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a4fc57ef-7bc6-43b6-ad6a-40d1f16b28d8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>

    </div>
  </div>
```
:::
:::
